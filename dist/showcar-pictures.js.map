{"version":3,"sources":["../src/showcar-pictures.js"],"names":[],"mappings":"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","file":"showcar-pictures.js","sourcesContent":["/**\n * Adds class to the dom element\n * @param {string} className  The class that has to be added\n * @param {Element} element   The element to add a class to\n * @return {Element}          the element to which the class has been added\n */\nfunction addClass(className, element) {\n  element.classList.add(className)\n  return element;\n}\n\n/**\n * Removed class from the dom element\n * @param  {string} className class to be removed\n * @param  {Element} element   the element to remove class from\n * @return {Element}           the element from which the class has been removed\n */\nfunction removeClass(className, element) {\n  element.classList.remove(className);\n  return element;\n}\n\n/**\n * checks whether an element has a class\n * @param  {string} className class to be removed\n * @param  {Element} element   the element to remove class from\n * @return {Boolean}\n */\nfunction containsClass(className, element) {\n  return element.classList.contains(className);\n}\n\nfunction dispatchEvent(evtName, payload, element) {\n  var evt = new CustomEvent(evtName, { detail: payload, bubbles: true });\n  element.dispatchEvent(evt);\n  return element;\n}\n\n/**\n * Gets parent el by class name\n * @param  {string} className\n * @param  {Element} element\n * @return {Boolean}\n */\nfunction getParentByClassName(className, element) {\n  while(element && !containsClass(className, element)) {\n    element = element.parentNode;\n  }\n  return element;\n}\n\nfunction merge(src1, src2) {\n  var res = {};\n  for (var k in src1) {\n    res[k] = src1[k];\n  }\n  for (var k in src2) {\n    res[k] = src2[k];\n  }\n  return res;\n}\n\nclass Pictures {\n\n  /** @constructor */\n  constructor(element) {\n    /**\n     * The root element\n     * @type {Element}\n     */\n    this.element = element;\n\n    /**\n     * Thether the thumbnail are visible on not\n     * @type {Boolean}\n     */\n    this.thumbnailsVisible = false;\n\n    /**\n     * The current state of the screen\n     * @type {Boolean}\n     */\n    this.fullScreenState = false;\n\n    this.element.addEventListener('as24-carousel.slide', function(e) {\n      let data;\n      e.stopPropagation();\n      if (e.detail.role === \"slider\") {\n        data = merge({ fullscreen: this.fullScreenState }, e.detail);\n        dispatchEvent('as24-pictures.slide', data, this.element);\n      }\n    }.bind(this));\n  }\n\n  /**\n   * Does init for thumbnails\n   */\n  initThumbnails() {\n    this.thumbnailsItems = this.thumbnails.querySelectorAll('.as24-carousel__item');\n\n    if(!this.thumbnailsItems) return;\n\n    addClass('active', this.thumbnailsItems[0]);\n\n    this.thumbnails.addEventListener('click', (evt) => {\n      evt.preventDefault();\n      const idx = Array.from(this.thumbnails.querySelectorAll('.as24-carousel__item')).indexOf(getParentByClassName('as24-carousel__item', evt.target));\n      if (idx >= 0) this.slider.goTo(idx + 1);\n    });\n  }\n\n  /**\n   * Adds all handlers for the slider carousel.\n   */\n  addSlider() {\n    this.slider.addEventListener('as24-carousel.slide', e => {\n      let index = e.detail.index;\n\n      switch(e.detail.role) {\n        case 'slider':\n          this.thumbnails.goTo(index, { notify: true });\n          break;\n        case 'thumbnails':\n          this.slider.goTo(index, { notify: true });\n          break;\n      }\n\n      [].forEach.call(this.thumbnailsItems, el => removeClass('active', el));\n      addClass('active', this.thumbnailsItems[index]);\n    });\n  }\n\n  /**\n   * Set the full screen state.\n   */\n  toggleFullScreen() {\n    // Prevent fullscreen mode on small devices\n    if (window.document.body.clientWidth < 1024) return;\n\n    this.fullScreenState = !this.fullScreenState;\n\n    if(this.fullScreenState) {\n      addClass('as24-pictures--fullscreen', this.element);\n    } else {\n      removeClass('as24-pictures--fullscreen', this.element);\n    }\n\n    dispatchEvent('as24-pictures.fullscreen', { fullscreen: this.fullScreenState }, this.element);\n\n    if (this.thumbnails) this.thumbnails.redraw(false);\n    if (this.slider) this.slider.redraw(false);\n  }\n\n  /**\n   * Adds all handlers for full screen view.\n   * {Event} event - the click event.\n   */\n  fullScreenOpenHandler(event) {\n    if(!this.fullScreenState && event.target.nodeName.toLowerCase() === 'img') {\n      this.toggleFullScreen();\n    }\n  }\n\n  fullScreenCloseHandler(event) {\n    if(this.fullScreenState && containsClass('as24-pictures__fullscreen-close', event.target)) {\n      this.toggleFullScreen();\n    }\n  }\n\n  /**\n   * Initializes the pictures by adding all necessary bits and bolts.\n   */\n  attached() {\n    this.container = this.element.querySelector('.as24-pictures__container');\n\n    // Slider\n    this.slider = this.element.querySelector('[role=slider]');\n    if(this.slider) {\n      this.addSlider();\n      this.fullScreenOpenListener = this.fullScreenOpenHandler.bind(this);\n      this.slider.addEventListener('click', this.fullScreenOpenListener);\n    }\n\n    // Thumbnails\n    this.thumbnails = this.element.querySelector('.as24-pictures__thumbnails');\n    if (this.thumbnails) this.initThumbnails();\n\n    this.fullScreenCloseListener = this.fullScreenCloseHandler.bind(this);\n    this.element.addEventListener('click', this.fullScreenCloseListener);\n\n    this.closeButton = this.element.querySelector('.as24-pictures__fullscreen-close');\n    if (this.closeButton) {\n      this.closeButton.addEventListener('click', this.fullScreenCloseListener);\n    }\n  }\n\n  /**\n   * Cleans up the pictures component by removing listeners and dom elements.\n   */\n  detached(){\n\n    this.fullScreen = this.element.querySelector('as24-pictures as24-carousel');\n    if(this.fullScreen) {\n      this.fullScreen.removeEventListener('click', this.fullScreenOpenListener);\n    }\n\n    this.closeButton = this.element.querySelector('.as24-pictures__fullscreen-close');\n    if(this.closeButton) {\n      this.closeButton.addEventListener('click', this.fullScreenCloseListener);\n    }\n\n    this.element.removeEventListener('click', this.fullScreenCloseListener);\n\n    this.removeContainer();\n  }\n\n  /**\n   * Removes the container.\n   */\n  removeContainer() {\n    Array.from(this.container.children).forEach(element => this.container.removeChild(element));\n    this.wrapper.removeChild(this.container);\n  }\n\n  /**\n   * Self-explanatory\n   * @param {number} slideIndex  Self-explanatory\n   * @return {void}\n   */\n  removeSlide(slideIndex) {\n    if (slideIndex > this.slider.carousel.container.children.length - 1) return;\n    this.slider.removeItem(slideIndex);\n    this.thumbnails.removeItem(slideIndex);\n  }\n\n}\n\n\n(function(){\n  /**\n   * Gets called after the element is created.\n   */\n  let elementCreatedHandler = function() {\n    this.pictures = new Pictures(this);\n  };\n\n  /**\n   * Gets called when the element is attached to the dom.\n   */\n  let elementAttachedHandler = function() {\n    this.pictures.attached();\n  };\n\n  /**\n   * Handler for detachment of the element from the dom.\n   */\n  let elementDetachedCallback = function() {\n    this.carousel.detached();\n    delete this.carousel;\n  };\n\n  /**\n   * Try to register the pictures component.\n   */\n  try {\n    document.registerElement('as24-pictures', {\n      prototype: Object.assign(\n        Object.create(HTMLElement.prototype, {\n          createdCallback:  { value: elementCreatedHandler },\n          attachedCallback: { value: elementAttachedHandler },\n          detachedCallback: { value: elementDetachedCallback },\n        }), {\n          removeSlide(slideIndex) {\n            this.pictures.removeSlide(slideIndex);\n          }\n        }\n      )\n    });\n  } catch (e) {\n    if (window && window.console) {\n      window.console.warn('Failed to register CustomElement \"as24-pictures\".', e);\n    }\n  }\n})();\n"]}